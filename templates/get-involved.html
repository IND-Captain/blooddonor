{% extends "layout.html" %}

{% block title %}Get Involved - Oasis{% endblock %}

{% block body_class %}page-get-involved{% endblock %}

{% block content %}
        <section class="page-header">
            <div class="container">
                <h1 class="page-title"><i class="fas fa-hands-helping"></i> Get Involved</h1>
                <p class="page-subtitle">Whether you want to donate blood or need to request it, you're in the right place.</p>
            </div>
        </section>

        <section class="form-section">
            <div class="container" id="get-involved-content">
                {% if session.user_id %}
                {# Show donor profile form if user is logged in #}
                <div class="form-container animate-on-scroll">
                    <div class="form-header">
                        <h3><i class="fas fa-user-check"></i> Your Donor Profile</h3>
                        <p style="color: var(--gray-600); font-size: 0.9rem; margin-top: 10px;">Keep your information up-to-date to help us connect you with those in need.</p>
                    </div>
                    <form action="{{ url_for('get_involved_page') }}" method="POST">
                        <input type="hidden" name="form_type" value="donor_update">
                        <div class="form-group">
                            <label for="donor-name" class="form-label">Full Name</label>
                            <input type="text" id="donor-name" name="name" class="form-input" value="{{ donor_data.name or '' }}" required>
                        </div>
                        <div class="form-group">
                            <label for="donor-dob" class="form-label">Date of Birth</label>
                            <input type="date" id="donor-dob" name="dob" class="form-input" value="{{ donor_data.dob.strftime('%Y-%m-%d') if donor_data.dob else '' }}" required>
                        </div>
                        <div class="form-group">
                            <label for="donor-gender" class="form-label">Gender</label>
                            <select id="donor-gender" name="gender" class="form-select" required><option value="Male" {{ 'selected' if donor_data.gender == 'Male' }}>Male</option><option value="Female" {{ 'selected' if donor_data.gender == 'Female' }}>Female</option><option value="Other" {{ 'selected' if donor_data.gender == 'Other' }}>Other</option></select>
                        </div>
                        <div class="form-group">
                            <label for="donor-contact" class="form-label">Contact Number</label>
                            <input type="tel" id="donor-contact" name="contact" class="form-input" value="{{ donor_data.contact or '' }}" required>
                        </div>
                        <div class="form-group">
                            <label for="donor-pincode" class="form-label">PIN Code</label>
                            <input type="text" id="donor-pincode" name="pincode" class="form-input" value="{{ donor_data.pincode or '' }}" required>
                        </div>
                        <div class="form-group">
                            <label for="donor-bloodgroup" class="form-label">Blood Group</label>
                            <select id="donor-bloodgroup" name="bloodgroup" class="form-select" required>{% set blood_groups = ['A+', 'A-', 'B+', 'B-', 'AB+', 'AB-', 'O+', 'O-'] %}{% for bg in blood_groups %}<option value="{{ bg }}" {{ 'selected' if donor_data.blood_group == bg }}>{{ bg }}</option>{% endfor %}</select>
                        </div>
                        <button type="submit" class="btn-submit">
                            <i class="fas fa-save"></i> Update Donor Profile
                        </button>
                    </form>
                </div>
                {% else %}
                {# Show login/signup if user is logged out #}
                <div id="auth-container" class="form-container animate-on-scroll" style="max-width: 500px; margin: 0 auto;">
                    <div class="auth-tabs">
                        <button class="auth-tab active" data-form="login">Login</button>
                        <button class="auth-tab" data-form="signup">Sign Up</button>
                    </div>
                    <form id="login-form" class="auth-form active" method="POST" action="{{ url_for('get_involved_page') }}">
                        <input type="hidden" name="form_type" value="login">
                        <div class="form-header" style="padding-bottom: 10px;"><h3><i class="fas fa-sign-in-alt"></i> Login to Your Account</h3></div>
                        <div class="form-group"><label for="login-email" class="form-label">Email or Username</label><input type="text" id="login-email" name="login-email" class="form-input" required></div>
                        <div class="form-group"><label for="login-password" class="form-label">Password</label><input type="password" id="login-password" name="login-password" class="form-input" required></div>
                        <button type="submit" class="btn-submit">Login</button>
                    </form>
                    <form id="signup-form" class="auth-form" method="POST" action="{{ url_for('get_involved_page') }}">
                        <input type="hidden" name="form_type" value="signup">
                        <div class="form-header" style="padding-bottom: 10px;"><h3><i class="fas fa-user-plus"></i> Create an Account</h3></div>
                        <div class="form-group"><label for="signup-name" class="form-label">Full Name</label><input type="text" id="signup-name" name="signup-name" class="form-input" placeholder="John Doe" required></div>
                        <div class="form-group"><label for="signup-email" class="form-label">Email</label><input type="email" id="signup-email" name="signup-email" class="form-input" required></div>
                        <div class="form-group"><label for="signup-dob" class="form-label">Date of Birth</label><input type="date" id="signup-dob" name="signup-dob" class="form-input" required></div>
                        <div class="form-group"><label for="signup-gender" class="form-label">Gender</label><select id="signup-gender" name="signup-gender" class="form-select" required><option value="" disabled selected>Select your gender</option><option value="Male">Male</option><option value="Female">Female</option><option value="Other">Other</option></select></div>
                        <div class="form-group"><label for="signup-contact" class="form-label">Contact Number</label><input type="tel" id="signup-contact" name="signup-contact" class="form-input" placeholder="Your contact number" required></div>
                        <div class="form-group"><label for="signup-pincode" class="form-label">PIN Code</label><input type="text" id="signup-pincode" name="signup-pincode" class="form-input" placeholder="e.g., 10001" required></div>
                        <div class="form-group"><label for="signup-bloodgroup" class="form-label">Blood Group</label><select id="signup-bloodgroup" name="signup-bloodgroup" class="form-select" required><option value="" disabled selected>Select blood group</option><option value="A+">A+</option><option value="A-">A-</option><option value="B+">B+</option><option value="B-">B-</option><option value="AB+">AB+</option><option value="AB-">AB-</option><option value="O+">O+</option><option value="O-">O-</option></select></div>
                        <div class="form-group"><label for="signup-password" class="form-label">Password</label><input type="password" id="signup-password" name="signup-password" class="form-input" required></div>
                        <div class="form-group"><label for="signup-confirm-password" class="form-label">Confirm Password</label><input type="password" id="signup-confirm-password" name="signup-confirm-password" class="form-input" required></div>
                        <button type="submit" class="btn-submit">Sign Up</button>
                    </form>
                </div>
                {% endif %}
            </div>
        </section>
{% endblock %}
{% extends "layout.html" %}

{% block title %}Inbox - Oasis{% endblock %}

{% block body_class %}page-inbox{% endblock %}

{% block content %}
<section class="page-header">
    <div class="container">
        <h1 class="page-title"><i class="fas fa-inbox"></i> Your Inbox</h1>
        <p class="page-subtitle">Manage your conversations with donors and requesters.</p>
    </div>
</section>

<section class="inbox-section">
    <div class="container">
        <div class="inbox-container">
            {% if conversations %}
                <ul class="conversation-list">
                    {% for convo in conversations %}
                    <li class="conversation-item animate-on-scroll {% if not convo.is_read and convo.sender_id != session.user_id %}unread{% endif %}">
                        <a href="{{ url_for('conversation_page', other_user_id=convo.user_id) }}">
                            <img src="{{ url_for('static', filename=convo.profile_picture_url) if convo.profile_picture_url else url_for('static', filename='images/default-avatar.png') }}" alt="Profile picture of {{ convo.username }}" class="profile-img-small">
                            <div class="convo-details">
                                <div class="convo-header">
                                    <h4 class="convo-username">{{ convo.username }}</h4>
                                    <span class="convo-time">{{ convo.created_at.strftime('%b %d, %Y') }}</span>
                                </div>
                                <p class="convo-preview">{{ convo.body | truncate(80) }}</p>
                            </div>
                        </a>
                    </li>
                    {% endfor %}
                </ul>
            {% else %}
                <p class="search-results-message">You have no messages yet.</p>
            {% endif %}
        </div>
    </div>
</section>
{% endblock %}